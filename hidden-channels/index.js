(function(r,n,s,p,y,C){"use strict";const{View:R,Text:d,Pressable:P}=p.findByProps("Button","Text","View"),h=p.findByProps("extractTimestamp"),a=s.stylesheet.createThemedStyleSheet({container:{flex:1,padding:16,alignItems:"center",justifyContent:"center"},title:{fontFamily:s.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:24,textAlign:"left",color:y.semanticColors.HEADER_PRIMARY,paddingVertical:25},text:{flex:1,flexDirection:"row",fontSize:16,textAlign:"justify",color:y.semanticColors.HEADER_PRIMARY},dateContainer:{height:16,alignSelf:"baseline"}});function f(t){let{date:e}=t;return React.createElement(P,{style:a.dateContainer,onPress:function(){s.toasts.open({content:s.moment(e).toLocaleString(),source:C.getAssetByName("clock").id})},onLongPress:function(){s.clipboard.setString(e.getTime().toString()),s.toasts.open({content:"Copied to clipboard"})}},React.createElement(d,{style:a.text},s.moment(e).fromNow()))}function E(t){let{channel:e}=t;return React.createElement(R,{style:a.container},React.createElement(d,{style:a.title},"This channel is hidden."),React.createElement(d,{style:a.text},"Topic: ",e.topic||"No topic.",`

`,"Creation date: ",React.createElement(f,{date:new Date(h.extractTimestamp(e.id))}),`

`,"Last message: ",e.lastMessageId?React.createElement(f,{date:new Date(h.extractTimestamp(e.lastMessageId))}):"No messages.",`

`,"Last pin: ",e.lastPinTimestamp?React.createElement(f,{date:new Date(e.lastPinTimestamp)}):"No pins."))}let l=[];const m=n.findByProps("getChannelPermissions","can"),T=n.findByProps("transitionToGuild"),M=n.findByProps("stores","fetchMessages"),{ChannelTypes:u}=n.findByProps("ChannelTypes"),{getChannel:x}=n.findByProps("getChannel"),B=[u.DM,u.GROUP_DM,u.GUILD_CATEGORY];function g(t){if(t==null||(typeof t=="string"&&(t=x(t)),!t||B.includes(t.type)))return!1;t.realCheck=!0;let e=!m.can(s.constants.Permissions.VIEW_CHANNEL,t);return delete t.realCheck,console.log(`isHidden: channel ${t?.id} hidden? ${e}`),e}function A(){const t=n.findByName("MessagesWrapperConnected",!1);if(!t){console.error("Hidden Channels plugin: 'MessagesWrapperConnected' component not found");return}l.push(n.after("can",m,function(e,o){let[i,c]=e;return!c?.realCheck&&i===s.constants.Permissions.VIEW_CHANNEL?!0:o})),l.push(n.instead("transitionToGuild",T,function(e,o){const[i,c]=e;!g(c)&&typeof o=="function"?o(e):console.log("Blocked transition to hidden channel:",c?.id)})),l.push(n.instead("fetchMessages",M,function(e,o){const[i]=e;!g(i)&&typeof o=="function"?o(e):console.log("Blocked fetching messages for hidden channel:",i?.id)})),l.push(n.instead("default",t,function(e,o){const i=e[0]?.channel;return!g(i)&&typeof o=="function"?o(...e):(console.log("Rendering HiddenChannel UI for channel:",i?.id),s.React.createElement(E,{channel:i}))}))}var I={onLoad:A,onUnload:function(){for(const t of l)t()}};return r.default=I,Object.defineProperty(r,"__esModule",{value:!0}),r})({},vendetta.patcher,vendetta.metro.common,vendetta.metro,vendetta.ui,vendetta.ui.assets);
